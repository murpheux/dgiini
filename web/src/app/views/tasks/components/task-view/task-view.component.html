<mat-card class="card view-card mb-3">
    <mat-card-header>
        <mat-card-subtitle>
            <div class="d-flex bd-highlight mb-3">
                <div class="p-2 bd-highlight">
                    <h3 id="#header">{{task.title | titlecase}}</h3>
                </div>
                <div class="p-2 bd-highlight">
                    <button type="button" class="btn btn-success">
                    {{task.status | titlecase}}
                </button>
                </div>
            </div>
        </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
        <div>
            <div class="budget border border-warning rounded-lg w-25 p-3 float-right text-center">
                <div>
                    <h2>Budget</h2>
                </div>
                <div *ngIf="task.lastbid" class="ramount text-danger">{{task.rate.amount | currency:'CAD' }}</div>
                <div class="c-gold">
                    <h2>{{currentPrice | currency:'CAD' }}</h2>
                </div>
                <div *ngIf="task.lastbid?.accepted">
                    <span class="statusBadge badge badge-success">Accepted!!</span>
                </div>
                <div *ngIf="!task.lastbid?.accepted" class="container">
                    <div class="row mb-2">
                        <div class="col">
                            <button type="button" class="btn btn-danger b-center Use btn-block" (click)="handleMakeOffer()"><i class="la la-dollar"></i>Make Offer</button>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col">
                            <button *ngIf="owned" type="button" class="btn btn-primary Use btn-block" (click)="handleAcceptOffer()"><mat-icon>money</mat-icon>Accept Offer</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <button *ngIf="owned" type="button" class="btn btn-danger Use btn-block" (click)="handleCancelTask()"><mat-icon>clear</mat-icon>Cancel Task</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ml-3">
                <div class="container">
                    <div class="row mb-2">
                        <div class="col-lg-1">
                            <mat-icon>person_pin</mat-icon>
                        </div>
                        <div class="col-lg-4">
                            <div class="font-weight-bold c-gold">Posted By</div>
                            <div class="">{{task.client.name}}</div>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-lg-1">
                            <mat-icon>location_on</mat-icon>
                        </div>
                        <div class="col-lg-4">
                            <div class="font-weight-bold c-gold">Location</div>
                            <div class="">{{task.location.street}} {{task.location.city}} {{task.location.state}}</div>
                        </div>
                    </div>
                    <div class="row lg-2">
                        <div class="col-lg-1">
                            <mat-icon>calendar_today</mat-icon>
                        </div>
                        <div class="col-lg-4">
                            <div class="font-weight-bold c-gold">Due Date</div>
                            <div class="">{{task.scheduled_date | date}}</div>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-lg-1">
                            <mat-icon>chrome_reader_mode</mat-icon>
                        </div>
                        <div class="col-lg-4">
                            <span class="font-weight-bold c-gold">Details</span>
                            <div class="">{{task.description}}</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ml-3">
                <div>
                    <mat-icon> message</mat-icon>
                    <span class="font-weight-bold c-gold">Messages</span>
                    <p class="">Please don't share personal info â€“ insurance won't apply to tasks not done through dgiini!</p>
                </div>
                <div *ngIf="currentUser">
                    <app-message-sender (messageSent)="handleMessageSent($event)" [currentUser]="currentUser" [from]="currentUser._id" [to]="task.client.id" [task]="task._id"></app-message-sender>
                </div>
                <div>
                    <app-message-list [messages]="messages"></app-message-list>
                </div>
            </div>
        </div>
    </mat-card-content>
</mat-card>