<div>
    <h3>//// New Task</h3>
</div>
<div class="container">
    <app-loader *ngIf="!taskFormGroup"></app-loader>
    <mat-card class="mcard">
        <form #taskForm="ngForm" [formGroup]="taskFormGroup" autocomplete="off" (ngSubmit)="handleSave(taskForm.value)">
            <mat-horizontal-stepper linear #stepper class="innerStepper">
                <mat-step formGroupName="task1FormGroup" [stepControl]="taskFormGroup.get('task1FormGroup')">
                    <ng-template matStepLabel>What do you need done?</ng-template>
                    <div class="d-flex flex-row">
                        <div class="flex-fill">
                            <div>
                                <mat-form-field class="full-width" floatLabel="always">
                                    <mat-label>What do you need done?</mat-label>
                                    <input matInput placeholder="enter title" formControlName="title">
                                </mat-form-field>
                            </div>
                            <div>
                                <mat-form-field class="full-width" floatLabel="always">
                                    <mat-label>What are the details</mat-label>
                                    <textarea matInput placeholder="enter details" formControlName="description" matAutosizeMinRows=3 matAutosizeMaxRows=5></textarea>
                                </mat-form-field>
                            </div>
                            <div>
                                <mat-form-field class="full-width" floatLabel="always">
                                    <mat-label>Select Task Category</mat-label>
                                    <mat-select formControlName="category">
                                        <mat-option *ngFor="let category of categoryList" [value]="category">{{category}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="mat-control d-flex justify-content-end">
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperNext>Next</button>
                    </div>
                </mat-step>
                <mat-step formGroupName="task2FormGroup" [stepControl]="taskFormGroup.get('task2FormGroup')">
                    <ng-template matStepLabel>What Location?</ng-template>
                    <div class="d-flex flex-row">
                        <div class="flex-fill">
                            <div>
                                <mat-label>Location</mat-label>
                                <p class="small font-italic">Note: Address will not be shared with prospect until bid has been accepted!</p>
                                <div>
                                    <mat-form-field class="full-width" floatLabel="always">
                                        <mat-label>Street</mat-label>
                                        <input matInput placeholder="enter street" formControlName="street" />
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col-lg-6">
                                    <mat-form-field>
                                        <mat-select formControlName="city">
                                            <mat-option *ngFor="let city of cities" [value]="city">{{city}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-lg-6">
                                    <mat-form-field>
                                        <mat-select formControlName="state">
                                            <mat-option *ngFor="let state of states" [value]="state">{{state}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="col-lg-4">
                                    <mat-form-field class="full-width" floatLabel="always">
                                        <mat-label>Postal Code</mat-label>
                                        <input matInput placeholder="enter postal code" formControlName="zipcode" />
                                    </mat-form-field>
                                </div>
                                <div class="col-lg-8">
                                    <mat-form-field>
                                        <mat-select formControlName="country">
                                            <mat-option *ngFor="let country of countries" [value]="country">{{country}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="mat-control d-flex justify-content-end">
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperPrevious>Back</button>
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperNext>Next</button>
                    </div>
                </mat-step>
                <mat-step formGroupName="task3FormGroup" [stepControl]="taskFormGroup.get('task3FormGroup')">
                    <ng-template matStepLabel>When do you need it done?</ng-template>
                    <div class="form-row">
                        <div class="col-lg-6">
                            <mat-form-field class="full-width" floatLabel="always">
                                <mat-label>When do you need it done?</mat-label>
                                <input matInput [matDatepicker]="dp" placeholder="" formControlName="taskdate">
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="matrcol-lg-6">
                            <div class="ngx-timepicker-field-example">
                                <ngx-timepicker-field [controlOnly]="true" formControlName="tasktime"></ngx-timepicker-field>
                            </div>
                        </div>
                    </div>
                    <div class="mat-control d-flex justify-content-end">
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperPrevious>Back</button>
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperNext>Next</button>
                    </div>
                </mat-step>
                <mat-step formGroupName="task4FormGroup" [stepControl]="taskFormGroup.get('task4FormGroup')">
                    <ng-template matStepLabel>Where do you need it done?</ng-template>
                    <div class="d-flex flex-row">
                        <div class="flex-fill">
                            <div>
                                <mat-label>Where do you need it done?</mat-label>
                                <div>
                                    <mat-radio-group aria-label="Select an option" formControlName="rateunit">
                                        <mat-radio-button *ngFor="let key of rateunits_keys" [value]="rateunits[key] | lowercase">{{ rateunits[key] }}</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                            </div>
                            <div>
                                <mat-form-field class="full-width" floatLabel="always">
                                    <mat-label>Amount</mat-label>
                                    <div class="input-group mb-2">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input matInput type="number" class="form-control" aria-label="Amount (to the nearest dollar)" formControlName="rate" appDigitOnly>
                                        <div class="input-group-append">
                                            <span class="input-group-text">.00</span>
                                        </div>
                                    </div>
                                </mat-form-field>
                            </div>
                            <div>
                                <div class="input-group mb-2">
                                    <span class="font-weight-bold">How long will the task take:</span>
                                    <mat-slider class="flex-fill" thumbLabel [displayWith]="formatLabel" formControlName="esthrs" tickInterval="5" min="1" max="50"></mat-slider> {{ taskFormGroup.get('task4FormGroup').get('esthrs').value }} hrs
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mat-control d-flex justify-content-end">
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperPrevious>Back</button>
                        <button type="button" class="btn btn-danger b-center" mat-button matStepperNext>Next</button>
                    </div>
                </mat-step>
                <mat-step>
                    <ng-template matStepLabel>Confirm</ng-template>
                    Confirm entry ...
                    <div>
                        <div>
                            <h4>Following details submitted, please confirm and hit post</h4>
                            <br/>Title: {{taskFormGroup.get('task1FormGroup').get('title').value}}
                            <br/>Description : {{taskFormGroup.get('task1FormGroup').get('description').value}}
                            <br/>Category : {{taskFormGroup.get('task1FormGroup').get('category').value}}
                            <br/>Address :{{taskFormGroup.get('task2FormGroup').get('street').value}} {{taskFormGroup.get('task2FormGroup').get('city').value}}, {{taskFormGroup.get('task2FormGroup').get('country').value}} {{taskFormGroup.get('task2FormGroup').get('zipcode').value}}
                            <br/>Scheduled Date :{{taskFormGroup.get('task3FormGroup').get('taskdate').value | date}}, {{taskFormGroup.get('task3FormGroup').get('tasktime').value}}
                            <br/>Rate :{{taskFormGroup.get('task4FormGroup').get('rate').value}}
                            <br/>Rate Unit :{{taskFormGroup.get('task4FormGroup').get('rateunit').value}}
                            <br/>Est. Hrs. :{{taskFormGroup.get('task4FormGroup').get('esthrs').value}}
                            <br/>
                        </div>

                    </div>
                    <div class="mat-control d-flex justify-content-end">
                        <button mat-button type="button" class="btn btn-danger b-center" matStepperPrevious>Back</button>
                        <button mat-button type="button" class="btn btn-danger b-center" (click)="stepper.reset()">Reset</button>
                        <button mat-button class="btn btn-primary b-center" type="submit">Post</button>
                    </div>
                </mat-step>
            </mat-horizontal-stepper>
        </form>
    </mat-card>

</div>