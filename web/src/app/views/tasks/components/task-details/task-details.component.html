<div class="container">
    <app-loader *ngIf="!model"></app-loader>
    <div>
        <div class="d-flex flex-row justify-content-between">
            <div class="p-2">

            </div>
            <div class="p-2">
                <button [hidden]="readonly" color="warn" id="btnEditTask" mat-stroked-button (click)="setEditMode()">Edit</button>
                <button [hidden]="!readonly" color="warn" id="btnEditTask" mat-stroked-button (click)="handleUpdateTask()">Save</button>
                <button [hidden]="!readonly" color="warn" id="btnEditTask" mat-stroked-button (click)="handleCancel()">Cancel</button>
                <button color="warn" id="btnDeleteTask" mat-stroked-button (click)="openConfirmationDialog(model.id)">Delete</button>
            </div>
        </div>


    </div>
    <mat-card *ngIf="model">
        <form *ngIf="taskFormGroup" [formGroup]="taskFormGroup" (ngSubmit)="handleUpdateTask()">
            <ng-template matStepLabel>Task Details</ng-template>
            <div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Id</mat-label>
                            <input readonly matInput placeholder="Placeholder" formControlName="id">
                            <mat-icon matSuffix>settings</mat-icon>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Title</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="Title" formControlName="title">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['title'].invalid">
                                <span *ngIf="taskFormGroup.controls['title'].errors.required">Title is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Description</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="Placeholder" formControlName="description">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['description'].invalid">
                                <span *ngIf="taskFormGroup.controls['description'].errors.required">Description is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Category</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="Category" formControlName="category">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['category'].invalid">
                                <span *ngIf="taskFormGroup.controls['category'].errors.required">Category is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Street</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="Placeholder" formControlName="street">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['street'].invalid">
                                <span *ngIf="taskFormGroup.controls['street'].errors.required">Street is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>City</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="city" formControlName="city">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['city'].invalid">
                                <span *ngIf="taskFormGroup.controls['city'].errors.required">City is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>State</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="state" formControlName="state">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['state'].invalid">
                                <span *ngIf="taskFormGroup.controls['state'].errors.required">State is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Zip Code</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="zipcode" formControlName="zipcode">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['zipcode'].invalid">
                                <span *ngIf="taskFormGroup.controls['zipcode'].errors.required">Zip Code is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Country</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="country" formControlName="country">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['country'].invalid">
                                <span *ngIf="taskFormGroup.controls['country'].errors.required">Country is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Estimated Hours</mat-label>
                            <input [readonly]="!readonly" matInput placeholder="zipcode" formControlName="estimated_hours">
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['estimated_hours'].invalid">
                                <span *ngIf="taskFormGroup.controls['estimated_hours'].errors.required">Est. Hours is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <!-- <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Description</mat-label>
                            <select matNativeControl formControlName="description">
                <option selected></option>
                <option *ngFor="let type of projectTypes" [value]="type.id">{{type.name}}</option>
              </select>
                            <mat-error *ngIf="taskFormGroup.controls['projectTypeId'].invalid">
                                <span *ngIf="taskFormGroup.controls['projectTypeId'].errors.required">Description is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Estimated Start Date</mat-label>
                            <input matInput [matDatepicker]="pickerExpectedStartDate" formControlName="expectedStartDate">
                            <mat-datepicker-toggle matSuffix [for]="pickerExpectedStartDate"></mat-datepicker-toggle>
                            <mat-datepicker #pickerExpectedStartDate></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Excecuting Agency</mat-label>
                            <select matNativeControl formControlName="executingAgencyId">
                <option selected></option>
                <option *ngFor="let entity of entities" [value]="entity.id">{{entity.name}}</option>
              </select>
                            <mat-error *ngIf="taskFormGroup.controls['executingAgencyId'].invalid">
                                <span *ngIf="taskFormGroup.controls['executingAgencyId'].errors.required">Excecuting Agency is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width">
                            <mat-label>Implementing Agency</mat-label>
                            <select matNativeControl formControlName="implementingAgencyId">
                <option selected></option>
                <option *ngFor="let entity of entities" [value]="entity.id">{{entity.name}}</option>
              </select>
                            <mat-error *ngIf="taskFormGroup.controls['implementingAgencyId'].invalid">
                                <span *ngIf="taskFormGroup.controls['implementingAgencyId'].errors.required">Implementing Agency is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-center">
                    <div class="flex-fill d-flex flex-row flex-wrap">
                        <div>
                            <mat-form-field class="full-width p-1">
                                <mat-label>Estimated Duration</mat-label>
                                <input matInput placeholder="Estimated duration" formControlName="estimatedDuration">
                                <mat-icon matSuffix></mat-icon>
                                <mat-error *ngIf="taskFormGroup.controls['estimatedDuration'].invalid">
                                    <span *ngIf="taskFormGroup.controls['estimatedDuration'].errors.required">Estimated duration is required</span>
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-form-field class="full-width p-1">
                                <mat-label>Duration Unit</mat-label>
                                <select matNativeControl formControlName="durationUnit">
                  <option selected></option>
                  <option *ngFor="let unit of durationUnits" [value]="unit.id">{{unit.name}}</option>
                </select>
                                <mat-error *ngIf="taskFormGroup.controls['durationUnit'].invalid">
                                    <span *ngIf="taskFormGroup.controls['durationUnit'].errors.required">Duration Unit is required</span>
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="flex-fill p-1">
                        &nbsp;
                    </div>
                </div>
                <div class="d-flex flex-row">
                    <div class="flex-fill p-1">
                        <mat-form-field class="full-width p-1">
                            <mat-label>Outline</mat-label>
                            <textarea matInput placeholder="project outline" formControlName="outline"></textarea>
                            <mat-icon matSuffix></mat-icon>
                            <mat-error *ngIf="taskFormGroup.controls['outline'].invalid">
                                <span *ngIf="taskFormGroup.controls['outline'].errors.required">Outline is required</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="d-flex flex-row flex-wrap">
                    <div class="p-1 flex-fill">
                        <span class="mat-headline">Strategic Objectives</span>
                        <div class="f-flex flex-column">
                            <div class="p-1" formArrayName="strategicObjectives" *ngFor="let so of getStrategicObjectives.controls; let i=index;">
                                <mat-slide-toggle [formControl]="so" color="accent">
                                    {{model.project.strategicObjectives[i].name}}
                                </mat-slide-toggle>
                            </div>
                        </div>
                    </div>
                    <div class="p-1 flex-fill">
                        <span class="mat-headline">Areas</span>
                        <div class="f-flex flex-column">
                            <div class="p-1" formArrayName="areas" *ngFor="let area of getAreas.controls; let i=index">
                                <mat-slide-toggle [formControl]="area" color="accent">
                                    {{model.project.areas[i].name}}
                                </mat-slide-toggle>
                            </div>
                        </div>
                    </div>
                </div> -->
                <hr>
                <div class="d-flex flex-row">
                    <div class="m-2"><button mat-stroked-button id="btnBack" (click)='handleBack()'>Back</button></div>
                    <!-- <div class="m-2"><button type="submit" color="primary" id="btnSaveProject" mat-stroked-button>Save</button></div> -->
                </div>
            </div>
        </form>
    </mat-card>
</div>