{"id":"Q0TS","dependencies":[{"name":"/Users/murpheux/Workspace/projects/dgiini/microservices/package.json","includedInParent":true,"mtime":1563323962672},{"name":"/Users/murpheux/Workspace/projects/dgiini/microservices/.babelrc","includedInParent":true,"mtime":1557029603000},{"name":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/package.json","includedInParent":true,"mtime":1561227911279},{"name":"../error","loc":{"line":3,"column":27},"parent":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/lib/auth/auth_provider.js","resolved":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/lib/error.js"},{"name":"process","parent":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/lib/auth/auth_provider.js","resolved":"/Users/murpheux/.config/yarn/global/node_modules/process/browser.js"}],"generated":{"js":"var process = require(\"process\");\nvar t=require(\"process\");const e=require(\"../error\").MongoError;class n{constructor(t){this.bson=t,this.authStore=[]}auth(n,r,i,o){let l=r.length;if(0===l)return void o(null,null);let u=0,h=null;const s=t=>{this._authenticateSingleConnection(n,t,i,(t,n)=>{l-=1,t?h=new e(t):n&&(n.$err||n.errmsg)?h=new e(n):u+=1,0===l&&(u>0?(this.addCredentials(i),o(null,!0)):(null==h&&(h=new e(`failed to authenticate using ${i.mechanism}`)),o(h,!1)))})},a=e=>t.nextTick(()=>s(e));for(;r.length>0;)a(r.shift())}_authenticateSingleConnection(){throw new Error(\"_authenticateSingleConnection must be overridden\")}addCredentials(t){this.authStore.some(e=>e.equals(t))||this.authStore.push(t)}reauthenticate(t,e,n){const r=this.authStore.slice(0);let i=r.length;if(0===i)return n(null,null);for(let o=0;o<r.length;o++)this.auth(t,e,r[o],function(t){0===(i-=1)&&n(t,null)})}logout(t){this.authStore=this.authStore.filter(e=>e.source!==t)}}module.exports={AuthProvider:n};"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":159,"column":0},"generated":{"line":2,"column":0}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":159,"column":0},"generated":{"line":2,"column":4}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":159,"column":0},"generated":{"line":2,"column":6}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":159,"column":0},"generated":{"line":2,"column":14}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":3,"column":0},"generated":{"line":2,"column":25}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":3,"column":0},"generated":{"line":2,"column":33}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":3,"column":0},"generated":{"line":2,"column":41}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":3,"column":0},"generated":{"line":2,"column":53}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":10,"column":0},"generated":{"line":2,"column":64}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":10,"column":0},"generated":{"line":2,"column":70}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":11,"column":0},"generated":{"line":2,"column":72}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":11,"column":0},"generated":{"line":2,"column":84}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":12,"column":0},"generated":{"line":2,"column":87}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":12,"column":0},"generated":{"line":2,"column":92}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":12,"column":0},"generated":{"line":2,"column":97}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":13,"column":0},"generated":{"line":2,"column":99}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":13,"column":0},"generated":{"line":2,"column":104}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":13,"column":0},"generated":{"line":2,"column":114}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":24,"column":0},"generated":{"line":2,"column":117}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":24,"column":0},"generated":{"line":2,"column":122}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":24,"column":0},"generated":{"line":2,"column":124}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":24,"column":0},"generated":{"line":2,"column":126}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":24,"column":0},"generated":{"line":2,"column":128}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":26,"column":0},"generated":{"line":2,"column":131}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":26,"column":0},"generated":{"line":2,"column":135}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":26,"column":0},"generated":{"line":2,"column":137}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":26,"column":0},"generated":{"line":2,"column":139}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":28,"column":0},"generated":{"line":2,"column":146}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":28,"column":0},"generated":{"line":2,"column":149}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":28,"column":0},"generated":{"line":2,"column":153}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":30,"column":0},"generated":{"line":2,"column":155}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":29,"column":0},"generated":{"line":2,"column":167}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":29,"column":0},"generated":{"line":2,"column":169}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":29,"column":0},"generated":{"line":2,"column":174}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":34,"column":0},"generated":{"line":2,"column":180}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":34,"column":0},"generated":{"line":2,"column":184}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":34,"column":0},"generated":{"line":2,"column":186}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":35,"column":0},"generated":{"line":2,"column":188}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":35,"column":0},"generated":{"line":2,"column":190}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":37,"column":0},"generated":{"line":2,"column":195}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":37,"column":0},"generated":{"line":2,"column":201}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":37,"column":0},"generated":{"line":2,"column":203}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":207}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":212}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":242}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":244}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":246}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":248}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":249}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":38,"column":0},"generated":{"line":2,"column":251}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":40,"column":0},"generated":{"line":2,"column":256}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":40,"column":0},"generated":{"line":2,"column":259}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":43,"column":0},"generated":{"line":2,"column":261}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":44,"column":0},"generated":{"line":2,"column":263}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":44,"column":0},"generated":{"line":2,"column":265}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":44,"column":0},"generated":{"line":2,"column":269}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":44,"column":0},"generated":{"line":2,"column":271}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":45,"column":0},"generated":{"line":2,"column":274}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":45,"column":0},"generated":{"line":2,"column":278}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":45,"column":0},"generated":{"line":2,"column":280}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":45,"column":0},"generated":{"line":2,"column":286}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":45,"column":0},"generated":{"line":2,"column":288}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":46,"column":0},"generated":{"line":2,"column":296}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":46,"column":0},"generated":{"line":2,"column":298}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":46,"column":0},"generated":{"line":2,"column":302}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":46,"column":0},"generated":{"line":2,"column":304}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":48,"column":0},"generated":{"line":2,"column":307}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":48,"column":0},"generated":{"line":2,"column":310}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":52,"column":0},"generated":{"line":2,"column":312}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":52,"column":0},"generated":{"line":2,"column":316}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":57,"column":0},"generated":{"line":2,"column":320}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":57,"column":0},"generated":{"line":2,"column":322}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":59,"column":0},"generated":{"line":2,"column":325}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":59,"column":0},"generated":{"line":2,"column":330}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":59,"column":0},"generated":{"line":2,"column":345}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":61,"column":0},"generated":{"line":2,"column":348}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":61,"column":0},"generated":{"line":2,"column":350}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":61,"column":0},"generated":{"line":2,"column":356}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":63,"column":0},"generated":{"line":2,"column":361}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":63,"column":0},"generated":{"line":2,"column":367}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":64,"column":0},"generated":{"line":2,"column":371}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":64,"column":0},"generated":{"line":2,"column":373}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":64,"column":0},"generated":{"line":2,"column":377}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":64,"column":0},"generated":{"line":2,"column":411}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":64,"column":0},"generated":{"line":2,"column":413}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":66,"column":0},"generated":{"line":2,"column":427}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":66,"column":0},"generated":{"line":2,"column":429}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":66,"column":0},"generated":{"line":2,"column":432}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":440}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":442}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":445}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":447}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":456}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":460}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":71,"column":0},"generated":{"line":2,"column":462}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":74,"column":0},"generated":{"line":2,"column":466}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":74,"column":0},"generated":{"line":2,"column":471}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":74,"column":0},"generated":{"line":2,"column":473}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":74,"column":0},"generated":{"line":2,"column":480}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":75,"column":0},"generated":{"line":2,"column":483}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":75,"column":0},"generated":{"line":2,"column":485}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":75,"column":0},"generated":{"line":2,"column":487}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":84,"column":0},"generated":{"line":2,"column":496}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":85,"column":0},"generated":{"line":2,"column":528}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":85,"column":0},"generated":{"line":2,"column":534}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":85,"column":0},"generated":{"line":2,"column":538}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":85,"column":0},"generated":{"line":2,"column":544}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":92,"column":0},"generated":{"line":2,"column":596}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":92,"column":0},"generated":{"line":2,"column":611}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":614}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":619}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":629}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":634}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":637}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":639}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":93,"column":0},"generated":{"line":2,"column":646}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":96,"column":0},"generated":{"line":2,"column":651}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":96,"column":0},"generated":{"line":2,"column":656}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":96,"column":0},"generated":{"line":2,"column":666}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":96,"column":0},"generated":{"line":2,"column":671}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":107,"column":0},"generated":{"line":2,"column":674}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":107,"column":0},"generated":{"line":2,"column":689}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":107,"column":0},"generated":{"line":2,"column":691}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":107,"column":0},"generated":{"line":2,"column":693}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":108,"column":0},"generated":{"line":2,"column":696}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":108,"column":0},"generated":{"line":2,"column":702}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":108,"column":0},"generated":{"line":2,"column":704}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":108,"column":0},"generated":{"line":2,"column":709}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":108,"column":0},"generated":{"line":2,"column":719}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":108,"column":0},"generated":{"line":2,"column":725}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":109,"column":0},"generated":{"line":2,"column":728}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":109,"column":0},"generated":{"line":2,"column":732}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":109,"column":0},"generated":{"line":2,"column":734}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":109,"column":0},"generated":{"line":2,"column":736}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":110,"column":0},"generated":{"line":2,"column":743}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":110,"column":0},"generated":{"line":2,"column":746}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":110,"column":0},"generated":{"line":2,"column":750}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":111,"column":0},"generated":{"line":2,"column":752}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":111,"column":0},"generated":{"line":2,"column":759}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":111,"column":0},"generated":{"line":2,"column":761}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":111,"column":0},"generated":{"line":2,"column":766}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":772}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":776}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":780}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":782}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":784}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":786}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":788}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":114,"column":0},"generated":{"line":2,"column":795}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":799}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":804}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":809}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":811}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":813}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":815}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":818}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":115,"column":0},"generated":{"line":2,"column":827}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":117,"column":0},"generated":{"line":2,"column":830}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":116,"column":0},"generated":{"line":2,"column":835}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":116,"column":0},"generated":{"line":2,"column":838}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":118,"column":0},"generated":{"line":2,"column":842}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":118,"column":0},"generated":{"line":2,"column":844}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":118,"column":0},"generated":{"line":2,"column":846}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":130,"column":0},"generated":{"line":2,"column":854}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":130,"column":0},"generated":{"line":2,"column":861}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":864}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":869}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":879}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":884}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":894}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":901}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":904}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":906}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":131,"column":0},"generated":{"line":2,"column":915}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":158,"column":0},"generated":{"line":2,"column":919}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":158,"column":0},"generated":{"line":2,"column":926}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":158,"column":0},"generated":{"line":2,"column":934}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":158,"column":0},"generated":{"line":2,"column":935}},{"source":"../node_modules/mongodb-core/lib/auth/auth_provider.js","original":{"line":158,"column":0},"generated":{"line":2,"column":948}}],"sources":{"../node_modules/mongodb-core/lib/auth/auth_provider.js":"'use strict';\n\nconst MongoError = require('../error').MongoError;\n\n/**\n * Creates a new AuthProvider, which dictates how to authenticate for a given\n * mechanism.\n * @class\n */\nclass AuthProvider {\n  constructor(bson) {\n    this.bson = bson;\n    this.authStore = [];\n  }\n\n  /**\n   * Authenticate\n   * @method\n   * @param {SendAuthCommand} sendAuthCommand Writes an auth command directly to a specific connection\n   * @param {Connection[]} connections Connections to authenticate using this authenticator\n   * @param {MongoCredentials} credentials Authentication credentials\n   * @param {authResultCallback} callback The callback to return the result from the authentication\n   */\n  auth(sendAuthCommand, connections, credentials, callback) {\n    // Total connections\n    let count = connections.length;\n\n    if (count === 0) {\n      callback(null, null);\n      return;\n    }\n\n    // Valid connections\n    let numberOfValidConnections = 0;\n    let errorObject = null;\n\n    const execute = connection => {\n      this._authenticateSingleConnection(sendAuthCommand, connection, credentials, (err, r) => {\n        // Adjust count\n        count = count - 1;\n\n        // If we have an error\n        if (err) {\n          errorObject = new MongoError(err);\n        } else if (r && (r.$err || r.errmsg)) {\n          errorObject = new MongoError(r);\n        } else {\n          numberOfValidConnections = numberOfValidConnections + 1;\n        }\n\n        // Still authenticating against other connections.\n        if (count !== 0) {\n          return;\n        }\n\n        // We have authenticated all connections\n        if (numberOfValidConnections > 0) {\n          // Store the auth details\n          this.addCredentials(credentials);\n          // Return correct authentication\n          callback(null, true);\n        } else {\n          if (errorObject == null) {\n            errorObject = new MongoError(`failed to authenticate using ${credentials.mechanism}`);\n          }\n          callback(errorObject, false);\n        }\n      });\n    };\n\n    const executeInNextTick = _connection => process.nextTick(() => execute(_connection));\n\n    // For each connection we need to authenticate\n    while (connections.length > 0) {\n      executeInNextTick(connections.shift());\n    }\n  }\n\n  /**\n   * Implementation of a single connection authenticating. Is meant to be overridden.\n   * Will error if called directly\n   * @ignore\n   */\n  _authenticateSingleConnection(/*sendAuthCommand, connection, credentials, callback*/) {\n    throw new Error('_authenticateSingleConnection must be overridden');\n  }\n\n  /**\n   * Adds credentials to store only if it does not exist\n   * @param {MongoCredentials} credentials credentials to add to store\n   */\n  addCredentials(credentials) {\n    const found = this.authStore.some(cred => cred.equals(credentials));\n\n    if (!found) {\n      this.authStore.push(credentials);\n    }\n  }\n\n  /**\n   * Re authenticate pool\n   * @method\n   * @param {SendAuthCommand} sendAuthCommand Writes an auth command directly to a specific connection\n   * @param {Connection[]} connections Connections to authenticate using this authenticator\n   * @param {authResultCallback} callback The callback to return the result from the authentication\n   */\n  reauthenticate(sendAuthCommand, connections, callback) {\n    const authStore = this.authStore.slice(0);\n    let count = authStore.length;\n    if (count === 0) {\n      return callback(null, null);\n    }\n\n    for (let i = 0; i < authStore.length; i++) {\n      this.auth(sendAuthCommand, connections, authStore[i], function(err) {\n        count = count - 1;\n        if (count === 0) {\n          callback(err, null);\n        }\n      });\n    }\n  }\n\n  /**\n   * Remove credentials that have been previously stored in the auth provider\n   * @method\n   * @param {string} source Name of database we are removing authStore details about\n   * @return {object}\n   */\n  logout(source) {\n    this.authStore = this.authStore.filter(credentials => credentials.source !== source);\n  }\n}\n\n/**\n * A function that writes authentication commands to a specific connection\n * @callback SendAuthCommand\n * @param {Connection} connection The connection to write to\n * @param {Command} command A command with a toBin method that can be written to a connection\n * @param {AuthWriteCallback} callback Callback called when command response is received\n */\n\n/**\n * A callback for a specific auth command\n * @callback AuthWriteCallback\n * @param {Error} err If command failed, an error from the server\n * @param {object} r The response from the server\n */\n\n/**\n * This is a result from an authentication strategy\n *\n * @callback authResultCallback\n * @param {error} error An error object. Set to null if no error present\n * @param {boolean} result The result of the authentication process\n */\n\nmodule.exports = { AuthProvider };\n"},"lineCount":null}},"error":null,"hash":"9132e918d10cfc77e7b5cf690fe6b43e","cacheData":{"env":{}}}