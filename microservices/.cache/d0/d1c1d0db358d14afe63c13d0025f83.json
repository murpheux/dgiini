{"id":"MOmv","dependencies":[{"name":"/Users/murpheux/Workspace/projects/dgiini/microservices/package.json","includedInParent":true,"mtime":1563323962672},{"name":"/Users/murpheux/Workspace/projects/dgiini/microservices/.babelrc","includedInParent":true,"mtime":1557029603000},{"name":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/package.json","includedInParent":true,"mtime":1561227911279},{"name":"./error","loc":{"line":2,"column":27},"parent":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/lib/transactions.js","resolved":"/Users/murpheux/Workspace/projects/dgiini/microservices/node_modules/mongodb-core/lib/error.js"}],"generated":{"js":"\"use strict\";const T=require(\"./error\").MongoError;let e,N;e={NO_TRANSACTION:\"NO_TRANSACTION\",STARTING_TRANSACTION:\"STARTING_TRANSACTION\",TRANSACTION_IN_PROGRESS:\"TRANSACTION_IN_PROGRESS\",TRANSACTION_COMMITTED:\"TRANSACTION_COMMITTED\",TRANSACTION_COMMITTED_EMPTY:\"TRANSACTION_COMMITTED_EMPTY\",TRANSACTION_ABORTED:\"TRANSACTION_ABORTED\"},N={NO_TRANSACTION:[\"NO_TRANSACTION\",\"STARTING_TRANSACTION\"],STARTING_TRANSACTION:[\"TRANSACTION_IN_PROGRESS\",\"TRANSACTION_COMMITTED\",\"TRANSACTION_COMMITTED_EMPTY\",\"TRANSACTION_ABORTED\"],TRANSACTION_IN_PROGRESS:[\"TRANSACTION_IN_PROGRESS\",\"TRANSACTION_COMMITTED\",\"TRANSACTION_ABORTED\"],TRANSACTION_COMMITTED:[\"TRANSACTION_COMMITTED\",\"TRANSACTION_COMMITTED_EMPTY\",\"STARTING_TRANSACTION\",\"NO_TRANSACTION\"],TRANSACTION_ABORTED:[\"STARTING_TRANSACTION\",\"NO_TRANSACTION\"],TRANSACTION_COMMITTED_EMPTY:[\"TRANSACTION_COMMITTED_EMPTY\",\"NO_TRANSACTION\"]};class A{constructor(N){if(N=N||{},this.state=e.NO_TRANSACTION,this.options={},N.writeConcern||void 0!==N.w){if((N.writeConcern?N.writeConcern.w:N.w)<=0)throw new T(\"Transactions do not support unacknowledged write concern\");this.options.writeConcern=N.writeConcern?N.writeConcern:{w:N.w}}N.readConcern&&(this.options.readConcern=N.readConcern),N.readPreference&&(this.options.readPreference=N.readPreference),this._pinnedServer=void 0,this._recoveryToken=void 0}get server(){return this._pinnedServer}get recoveryToken(){return this._recoveryToken}get isPinned(){return!!this.server}get isActive(){return-1!==[e.STARTING_TRANSACTION,e.TRANSACTION_IN_PROGRESS].indexOf(this.state)}transition(A){const r=N[this.state];if(r&&-1!==r.indexOf(A))return this.state=A,void(this.state!==e.NO_TRANSACTION&&this.state!==e.STARTING_TRANSACTION||this.unpinServer());throw new T(`Attempted illegal state transition from [${this.state}] to [${A}]`)}pinServer(T){this.isActive&&(this._pinnedServer=T)}unpinServer(){this._pinnedServer=void 0}}function r(T){return!(!T.commitTransaction&&!T.abortTransaction)}module.exports={TxnState:e,Transaction:A,isTransactionCommand:r};"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":2,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":2,"column":0},"generated":{"line":1,"column":19}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":2,"column":0},"generated":{"line":1,"column":21}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":2,"column":0},"generated":{"line":1,"column":29}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":2,"column":0},"generated":{"line":1,"column":40}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":4,"column":0},"generated":{"line":1,"column":51}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":4,"column":0},"generated":{"line":1,"column":55}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":5,"column":0},"generated":{"line":1,"column":57}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":15,"column":0},"generated":{"line":1,"column":59}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":15,"column":0},"generated":{"line":1,"column":61}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":16,"column":0},"generated":{"line":1,"column":62}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":8,"column":0},"generated":{"line":1,"column":77}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":17,"column":0},"generated":{"line":1,"column":94}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":9,"column":0},"generated":{"line":1,"column":115}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":18,"column":0},"generated":{"line":1,"column":138}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":10,"column":0},"generated":{"line":1,"column":162}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":19,"column":0},"generated":{"line":1,"column":188}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":11,"column":0},"generated":{"line":1,"column":210}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":20,"column":0},"generated":{"line":1,"column":234}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":12,"column":0},"generated":{"line":1,"column":262}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":21,"column":0},"generated":{"line":1,"column":292}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":13,"column":0},"generated":{"line":1,"column":312}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":24,"column":0},"generated":{"line":1,"column":335}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":24,"column":0},"generated":{"line":1,"column":337}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":25,"column":0},"generated":{"line":1,"column":338}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":25,"column":0},"generated":{"line":1,"column":353}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":8,"column":0},"generated":{"line":1,"column":354}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":9,"column":0},"generated":{"line":1,"column":371}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":26,"column":0},"generated":{"line":1,"column":395}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":26,"column":0},"generated":{"line":1,"column":416}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":10,"column":0},"generated":{"line":1,"column":417}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":11,"column":0},"generated":{"line":1,"column":443}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":12,"column":0},"generated":{"line":1,"column":467}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":13,"column":0},"generated":{"line":1,"column":497}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":32,"column":0},"generated":{"line":1,"column":520}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":32,"column":0},"generated":{"line":1,"column":544}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":10,"column":0},"generated":{"line":1,"column":545}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":11,"column":0},"generated":{"line":1,"column":571}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":13,"column":0},"generated":{"line":1,"column":595}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":37,"column":0},"generated":{"line":1,"column":618}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":37,"column":0},"generated":{"line":1,"column":640}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":11,"column":0},"generated":{"line":1,"column":641}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":12,"column":0},"generated":{"line":1,"column":665}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":9,"column":0},"generated":{"line":1,"column":695}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":8,"column":0},"generated":{"line":1,"column":718}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":43,"column":0},"generated":{"line":1,"column":736}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":43,"column":0},"generated":{"line":1,"column":756}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":9,"column":0},"generated":{"line":1,"column":757}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":8,"column":0},"generated":{"line":1,"column":780}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":44,"column":0},"generated":{"line":1,"column":798}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":44,"column":0},"generated":{"line":1,"column":826}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":12,"column":0},"generated":{"line":1,"column":827}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":8,"column":0},"generated":{"line":1,"column":857}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":80,"column":0},"generated":{"line":1,"column":876}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":80,"column":0},"generated":{"line":1,"column":882}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":87,"column":0},"generated":{"line":1,"column":884}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":87,"column":0},"generated":{"line":1,"column":896}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":899}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":88,"column":0},"generated":{"line":1,"column":902}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":88,"column":0},"generated":{"line":1,"column":904}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":88,"column":0},"generated":{"line":1,"column":907}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":90,"column":0},"generated":{"line":1,"column":910}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":90,"column":0},"generated":{"line":1,"column":915}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":90,"column":0},"generated":{"line":1,"column":921}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":90,"column":0},"generated":{"line":1,"column":923}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":91,"column":0},"generated":{"line":1,"column":938}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":91,"column":0},"generated":{"line":1,"column":943}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":91,"column":0},"generated":{"line":1,"column":951}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":954}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":956}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":975}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":979}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":981}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":93,"column":0},"generated":{"line":1,"column":983}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":95,"column":0},"generated":{"line":1,"column":984}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":988}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":990}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":1003}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":1005}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":1018}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":1020}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":94,"column":0},"generated":{"line":1,"column":1022}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":95,"column":0},"generated":{"line":1,"column":1026}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":96,"column":0},"generated":{"line":1,"column":1028}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":96,"column":0},"generated":{"line":1,"column":1034}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":96,"column":0},"generated":{"line":1,"column":1038}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":96,"column":0},"generated":{"line":1,"column":1040}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1100}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1105}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1113}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1126}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1128}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1141}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1143}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1156}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1157}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1159}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":99,"column":0},"generated":{"line":1,"column":1161}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1164}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1166}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1180}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1185}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1193}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1205}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":102,"column":0},"generated":{"line":1,"column":1207}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1220}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1222}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1239}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1244}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1252}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1267}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":103,"column":0},"generated":{"line":1,"column":1269}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":106,"column":0},"generated":{"line":1,"column":1285}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":106,"column":0},"generated":{"line":1,"column":1290}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":106,"column":0},"generated":{"line":1,"column":1309}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":107,"column":0},"generated":{"line":1,"column":1311}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":107,"column":0},"generated":{"line":1,"column":1316}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":107,"column":0},"generated":{"line":1,"column":1336}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":110,"column":0},"generated":{"line":1,"column":1338}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":111,"column":0},"generated":{"line":1,"column":1351}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":111,"column":0},"generated":{"line":1,"column":1358}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":111,"column":0},"generated":{"line":1,"column":1363}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":114,"column":0},"generated":{"line":1,"column":1377}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":115,"column":0},"generated":{"line":1,"column":1397}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":115,"column":0},"generated":{"line":1,"column":1404}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":115,"column":0},"generated":{"line":1,"column":1409}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":118,"column":0},"generated":{"line":1,"column":1424}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":119,"column":0},"generated":{"line":1,"column":1439}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":119,"column":0},"generated":{"line":1,"column":1447}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":119,"column":0},"generated":{"line":1,"column":1452}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":126,"column":0},"generated":{"line":1,"column":1459}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":127,"column":0},"generated":{"line":1,"column":1474}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1481}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1485}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1486}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1488}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1509}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1511}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1536}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1544}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":128,"column":0},"generated":{"line":1,"column":1549}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":137,"column":0},"generated":{"line":1,"column":1556}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":137,"column":0},"generated":{"line":1,"column":1567}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":138,"column":0},"generated":{"line":1,"column":1570}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":138,"column":0},"generated":{"line":1,"column":1576}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":138,"column":0},"generated":{"line":1,"column":1578}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":138,"column":0},"generated":{"line":1,"column":1580}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":138,"column":0},"generated":{"line":1,"column":1585}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":139,"column":0},"generated":{"line":1,"column":1592}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":139,"column":0},"generated":{"line":1,"column":1595}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":139,"column":0},"generated":{"line":1,"column":1599}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":139,"column":0},"generated":{"line":1,"column":1603}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":139,"column":0},"generated":{"line":1,"column":1605}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":139,"column":0},"generated":{"line":1,"column":1613}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":144,"column":0},"generated":{"line":1,"column":1616}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":140,"column":0},"generated":{"line":1,"column":1623}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":140,"column":0},"generated":{"line":1,"column":1628}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":140,"column":0},"generated":{"line":1,"column":1634}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1641}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1646}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1654}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1656}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1672}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1677}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1685}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1687}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":142,"column":0},"generated":{"line":1,"column":1709}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":142,"column":0},"generated":{"line":1,"column":1714}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":147,"column":0},"generated":{"line":1,"column":1729}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":147,"column":0},"generated":{"line":1,"column":1735}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":147,"column":0},"generated":{"line":1,"column":1739}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":148,"column":0},"generated":{"line":1,"column":1785}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":148,"column":0},"generated":{"line":1,"column":1790}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":148,"column":0},"generated":{"line":1,"column":1804}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":152,"column":0},"generated":{"line":1,"column":1810}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":152,"column":0},"generated":{"line":1,"column":1820}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":153,"column":0},"generated":{"line":1,"column":1823}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":153,"column":0},"generated":{"line":1,"column":1828}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":154,"column":0},"generated":{"line":1,"column":1839}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":154,"column":0},"generated":{"line":1,"column":1844}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":154,"column":0},"generated":{"line":1,"column":1858}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":158,"column":0},"generated":{"line":1,"column":1861}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":159,"column":0},"generated":{"line":1,"column":1875}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":159,"column":0},"generated":{"line":1,"column":1880}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":159,"column":0},"generated":{"line":1,"column":1899}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":163,"column":0},"generated":{"line":1,"column":1902}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":163,"column":0},"generated":{"line":1,"column":1911}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":163,"column":0},"generated":{"line":1,"column":1913}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":164,"column":0},"generated":{"line":1,"column":1916}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":164,"column":0},"generated":{"line":1,"column":1925}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":164,"column":0},"generated":{"line":1,"column":1927}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":164,"column":0},"generated":{"line":1,"column":1947}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":164,"column":0},"generated":{"line":1,"column":1949}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":1967}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":1974}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":1982}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":1983}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":1992}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":1994}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":2006}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":2008}},{"source":"../node_modules/mongodb-core/lib/transactions.js","original":{"line":167,"column":0},"generated":{"line":1,"column":2029}}],"sources":{"../node_modules/mongodb-core/lib/transactions.js":"'use strict';\nconst MongoError = require('./error').MongoError;\n\nlet TxnState;\nlet stateMachine;\n\n(() => {\n  const NO_TRANSACTION = 'NO_TRANSACTION';\n  const STARTING_TRANSACTION = 'STARTING_TRANSACTION';\n  const TRANSACTION_IN_PROGRESS = 'TRANSACTION_IN_PROGRESS';\n  const TRANSACTION_COMMITTED = 'TRANSACTION_COMMITTED';\n  const TRANSACTION_COMMITTED_EMPTY = 'TRANSACTION_COMMITTED_EMPTY';\n  const TRANSACTION_ABORTED = 'TRANSACTION_ABORTED';\n\n  TxnState = {\n    NO_TRANSACTION,\n    STARTING_TRANSACTION,\n    TRANSACTION_IN_PROGRESS,\n    TRANSACTION_COMMITTED,\n    TRANSACTION_COMMITTED_EMPTY,\n    TRANSACTION_ABORTED\n  };\n\n  stateMachine = {\n    [NO_TRANSACTION]: [NO_TRANSACTION, STARTING_TRANSACTION],\n    [STARTING_TRANSACTION]: [\n      TRANSACTION_IN_PROGRESS,\n      TRANSACTION_COMMITTED,\n      TRANSACTION_COMMITTED_EMPTY,\n      TRANSACTION_ABORTED\n    ],\n    [TRANSACTION_IN_PROGRESS]: [\n      TRANSACTION_IN_PROGRESS,\n      TRANSACTION_COMMITTED,\n      TRANSACTION_ABORTED\n    ],\n    [TRANSACTION_COMMITTED]: [\n      TRANSACTION_COMMITTED,\n      TRANSACTION_COMMITTED_EMPTY,\n      STARTING_TRANSACTION,\n      NO_TRANSACTION\n    ],\n    [TRANSACTION_ABORTED]: [STARTING_TRANSACTION, NO_TRANSACTION],\n    [TRANSACTION_COMMITTED_EMPTY]: [TRANSACTION_COMMITTED_EMPTY, NO_TRANSACTION]\n  };\n})();\n\n/**\n * The MongoDB ReadConcern, which allows for control of the consistency and isolation properties\n * of the data read from replica sets and replica set shards.\n * @typedef {Object} ReadConcern\n * @property {'local'|'available'|'majority'|'linearizable'|'snapshot'} level The readConcern Level\n * @see https://docs.mongodb.com/manual/reference/read-concern/\n */\n\n/**\n * A MongoDB WriteConcern, which describes the level of acknowledgement\n * requested from MongoDB for write operations.\n * @typedef {Object} WriteConcern\n * @property {number|'majority'|string} [w=1] requests acknowledgement that the write operation has\n * propagated to a specified number of mongod hosts\n * @property {boolean} [j=false] requests acknowledgement from MongoDB that the write operation has\n * been written to the journal\n * @property {number} [wtimeout] a time limit, in milliseconds, for the write concern\n * @see https://docs.mongodb.com/manual/reference/write-concern/\n */\n\n/**\n * Configuration options for a transaction.\n * @typedef {Object} TransactionOptions\n * @property {ReadConcern} [readConcern] A default read concern for commands in this transaction\n * @property {WriteConcern} [writeConcern] A default writeConcern for commands in this transaction\n * @property {ReadPreference} [readPreference] A default read preference for commands in this transaction\n */\n\n/**\n * A class maintaining state related to a server transaction. Internal Only\n * @ignore\n */\nclass Transaction {\n  /**\n   * Create a transaction\n   *\n   * @ignore\n   * @param {TransactionOptions} [options] Optional settings\n   */\n  constructor(options) {\n    options = options || {};\n\n    this.state = TxnState.NO_TRANSACTION;\n    this.options = {};\n\n    if (options.writeConcern || typeof options.w !== 'undefined') {\n      const w = options.writeConcern ? options.writeConcern.w : options.w;\n      if (w <= 0) {\n        throw new MongoError('Transactions do not support unacknowledged write concern');\n      }\n\n      this.options.writeConcern = options.writeConcern ? options.writeConcern : { w: options.w };\n    }\n\n    if (options.readConcern) this.options.readConcern = options.readConcern;\n    if (options.readPreference) this.options.readPreference = options.readPreference;\n\n    // TODO: This isn't technically necessary\n    this._pinnedServer = undefined;\n    this._recoveryToken = undefined;\n  }\n\n  get server() {\n    return this._pinnedServer;\n  }\n\n  get recoveryToken() {\n    return this._recoveryToken;\n  }\n\n  get isPinned() {\n    return !!this.server;\n  }\n\n  /**\n   * @ignore\n   * @return Whether this session is presently in a transaction\n   */\n  get isActive() {\n    return (\n      [TxnState.STARTING_TRANSACTION, TxnState.TRANSACTION_IN_PROGRESS].indexOf(this.state) !== -1\n    );\n  }\n\n  /**\n   * Transition the transaction in the state machine\n   * @ignore\n   * @param {TxnState} state The new state to transition to\n   */\n  transition(nextState) {\n    const nextStates = stateMachine[this.state];\n    if (nextStates && nextStates.indexOf(nextState) !== -1) {\n      this.state = nextState;\n      if (this.state === TxnState.NO_TRANSACTION || this.state === TxnState.STARTING_TRANSACTION) {\n        this.unpinServer();\n      }\n      return;\n    }\n\n    throw new MongoError(\n      `Attempted illegal state transition from [${this.state}] to [${nextState}]`\n    );\n  }\n\n  pinServer(server) {\n    if (this.isActive) {\n      this._pinnedServer = server;\n    }\n  }\n\n  unpinServer() {\n    this._pinnedServer = undefined;\n  }\n}\n\nfunction isTransactionCommand(command) {\n  return !!(command.commitTransaction || command.abortTransaction);\n}\n\nmodule.exports = { TxnState, Transaction, isTransactionCommand };\n"},"lineCount":null}},"error":null,"hash":"b6d48dae5c60570ab9b787a7a0acab03","cacheData":{"env":{}}}